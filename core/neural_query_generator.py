from docx import Document
from docx.shared import Inches
from docx.enum.text import WD_ALIGN_PARAGRAPH
import os
import logging

log = logging.getLogger(__name__)

def create_neural_query_document(output_path: str):
    """
    –°—Ç–≤–æ—Ä—é—î –¥–æ–∫—É–º–µ–Ω—Ç Word –∑ –∑–∞–ø–∏—Ç–æ–º –¥–ª—è –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂—ñ –ø–æ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–µ—Å—Ç—ñ–≤.
    
    Args:
        output_path: –®–ª—è—Ö –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
    """
    try:
        # –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
        doc = Document()
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = doc.add_heading('–ó–∞–ø–∏—Ç –¥–ª—è –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂—ñ: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–µ—Å—Ç—ñ–≤', 0)
        title.alignment = WD_ALIGN_PARAGRAPH.CENTER
        
        # –û—Å–Ω–æ–≤–Ω–∏–π –∑–∞–ø–∏—Ç
        doc.add_heading('–ó–∞–ø–∏—Ç –¥–ª—è –®–Ü:', level=1)
        
        query_text = """
–ó–≥–µ–Ω–µ—Ä—É–π —Ç–∞–±–ª–∏—Ü—é –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å –Ω–∞ [–ö–Ü–õ–¨–ö–Ü–°–¢–¨] –ø–∏—Ç–∞–Ω—å, —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å "[–°–ö–õ–ê–î–ù–Ü–°–¢–¨]" —Ç–∞ —Ç–µ–º—É "[–¢–ï–ú–ê]". –£—Ç–æ—á–Ω–∏ –≤ –¥—ñ–∞–ª–æ–∑—ñ –∫–æ–∂–µ–Ω –ø—É–Ω–∫—Ç.

–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —è —Ö–æ—á—É –æ—Ç—Ä–∏–º–∞—Ç–∏ Excel —Ç–∞–±–ª–∏—Ü—é:

1-–π —Å—Ç–æ–≤–ø—á–∏–∫: –ù–æ–º–µ—Ä –∑–∞–≤–¥–∞–Ω–Ω—è (–∑—Ä–æ–±–∏ –ø–æ –¥–µ–∫—ñ–ª—å–∫–∞ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ø–µ—Ä—à–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –¥–ª—è –≤–∞—Ä—ñ–∞—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ä—ñ–∑–Ω–∏—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤, –¥–µ–∫—ñ–ª—å–∫–∞ –¥—Ä—É–≥–æ–≥–æ —Ç–æ—â–æ)
2-–π —Å—Ç–æ–≤–ø—á–∏–∫: –°–∞–º–µ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ
3-–π —Å—Ç–æ–≤–ø—á–∏–∫: –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ç–µ—Å—Ç–æ–≤–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –∞–±–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –Ø–∫—â–æ –ø–∏—Ç–∞–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–µ - –≤–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É –ª—ñ—Ç–µ—Ä—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–ê, –ë, –í, –ì —Ç–æ—â–æ). –î–ª—è –ø–∏—Ç–∞–Ω—å –∑ –∫—ñ–ª—å–∫–æ–º–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—è–º–∏ –≤–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –ª—ñ—Ç–µ—Ä–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: –ê–í–ì –∞–±–æ –ê,–ë,–í). –Ø–∫—â–æ –∑ –≤—ñ–¥–∫—Ä–∏—Ç–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥—é - –≤–∫–∞–∑–∞—Ç–∏ —Ç–µ–∫—Å—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –í–ê–ñ–õ–ò–í–û –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –ø–∏—Ç–∞–Ω—å: –≤—ñ–¥–ø–æ–≤—ñ–¥—å –º–∞—î –±—É—Ç–∏ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—é, –±–µ–∑ –≤–∞—Ä—ñ–∞—Ü—ñ–π, —É–Ω–∏–∫–∞–π—Ç–µ —ñ–Ω–¥–µ–∫—Å—ñ–≤ —Ç–∞ –ø–æ–∑–Ω–∞—á–µ–Ω—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–¥–Ω—ñ –π —Ç—ñ –∂ –æ–¥–∏–Ω–∏—Ü—ñ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è, –≤—ñ–¥–¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥—É –æ–¥–Ω–æ–º—É —Å–ª–æ–≤—É –∞–±–æ —á–∏—Å–ª—É
4-–π —Å—Ç–æ–≤–ø—á–∏–∫: –í—ñ–¥–Ω–æ—Å–Ω–∞ –≤–∞–≥–∞ –∑–∞–≤–¥–∞–Ω–Ω—è. –î–ª—è –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å –ø—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è —Ä–æ–±–∏—Ç–∏ —á–∏—Å–ª–æ 2, 3 –ø—Ä–æ—Ç–∏ 1 –∑–∞ –∑–≤–∏—á–∞–π–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è
5-–π —Å—Ç–æ–≤–ø—á–∏–∫: –í–∞—Ä—ñ–∞–Ω—Ç –ê
6-–π —Å—Ç–æ–≤–ø—á–∏–∫: –í–∞—Ä—ñ–∞–Ω—Ç –ë
7-–π —Å—Ç–æ–≤–ø—á–∏–∫: –í–∞—Ä—ñ–∞–Ω—Ç –í
8-–π —Å—Ç–æ–≤–ø—á–∏–∫: –í–∞—Ä—ñ–∞–Ω—Ç –ì
9-–π —Å—Ç–æ–≤–ø—á–∏–∫: –¢–∏–ø –∑–∞–≤–¥–∞–Ω–Ω—è. –í–∫–∞–∑–∞—Ç–∏ –æ–¥–∏–Ω –∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤: "–¢–û" (—Ç–µ—Å—Ç–æ–≤–µ –∑ –æ–¥–Ω–∏–º –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º), "–¢–ö" (—Ç–µ—Å—Ç–æ–≤–µ –∑ –∫—ñ–ª—å–∫–æ–º–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∞–º–∏), "–í–ü" (–≤—ñ–¥–∫—Ä–∏—Ç–µ –ø–∏—Ç–∞–Ω–Ω—è)

–í–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (—Å—Ç–æ–≤–ø—á–∏–∫–∏ 5-8): –Ø–∫—â–æ –ø–∏—Ç–∞–Ω–Ω—è –∑ –≤—ñ–¥–∫—Ä–∏—Ç–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥—é —Ü—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –Ω–µ —Ç—Ä–µ–±–∞ –∑–∞–ø–æ–≤–Ω—é–≤–∞—Ç–∏. –Ø–∫—â–æ —î –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —Ç–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –º—ñ–Ω—ñ–º—É–º –¥–≤–∞ –≤–∞—Ä—ñ–∞–Ω—Ç–∏. 

üìù –ê–õ–§–ê–í–Ü–¢ –î–õ–Ø –ü–û–ó–ù–ê–ß–ï–ù–ù–Ø –í–ê–†–Ü–ê–ù–¢–Ü–í:
–í–∞—Ä—ñ–∞–Ω—Ç–∏ –ø–æ–∑–Ω–∞—á–∞—é—Ç—å—Å—è –ª—ñ—Ç–µ—Ä–∞–º–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–≥–æ –∞–ª—Ñ–∞–≤—ñ—Ç—É –≤ —Ç–∞–∫–æ–º—É –ø–æ—Ä—è–¥–∫—É: –ê, –ë, –í, –ì, –î, –ï, –ñ, –ó, –ò, –ö, –õ, –ú, –ù, –û, –ü, –†, –°, –¢, –£, –§, –•, –¶, –ß, –®, –©, –Æ, –Ø.
–í–ò–ö–õ–Æ–ß–ï–ù–Ü –õ–Ü–¢–ï–†–ò: “ê, –Ñ, –Ü, –á, –ô, –¨ (—Ü—ñ –ª—ñ—Ç–µ—Ä–∏ –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤).
–ù–∞–π—á–∞—Å—Ç—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø–µ—Ä—à—ñ 4-5 –ª—ñ—Ç–µ—Ä: –ê, –ë, –í, –ì, –î.
–î–ª—è –ø–∏—Ç–∞–Ω—å –∑ –∫—ñ–ª—å–∫–æ–º–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—è–º–∏ –≤–∫–∞–∑—É–π—Ç–µ –≤—Å—ñ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ª—ñ—Ç–µ—Ä–∏ —Ä–∞–∑–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: –ê–í–ì).

‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û –î–õ–Ø –ú–ê–¢–ï–ú–ê–¢–ò–ß–ù–ò–• –§–û–†–ú–£–õ:
–í—Å—ñ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –≤–∏—Ä–∞–∑–∏ –±—É–¥—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞—Ç–∏—Å—è —Ç–∞ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏—Å—è —É Word –¥–æ–∫—É–º–µ–Ω—Ç—ñ. –¢–æ–º—É:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥—Ä–æ–±–∏ —É —Ñ–æ—Ä–º–∞—Ç—ñ (—á–∏—Å–µ–ª—å–Ω–∏–∫)/(–∑–Ω–∞–º–µ–Ω–Ω–∏–∫), –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: (x - 1)/(x + 1)
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å—Ç–µ–ø–µ–Ω—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ –æ—Å–Ω–æ–≤–∞^–ø–æ–∫–∞–∑–Ω–∏–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: x^2, 2^3
- –î–æ–¥–∞–≤–∞–π—Ç–µ –¥—É–∂–∫–∏ –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤: (a+b)^2, (x - 1)/(x + 1)
- –î–ª—è –∫–æ—Ä–µ–Ω—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ sqrt(–≤–∏—Ä–∞–∑): sqrt(x^2 + 1)
- –î–ª—è –∑–º—ñ—à–∞–Ω–∏—Ö —á–∏—Å–µ–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–æ–±—ñ–ª –º—ñ–∂ —Ü—ñ–ª–æ—é —Ç–∞ –¥—Ä–æ–±–æ–≤–æ—é —á–∞—Å—Ç–∏–Ω–æ—é: "1 3/5" (–æ–¥–Ω–∞ —Ü—ñ–ª–∞ —ñ —Ç—Ä–∏ –ø'—è—Ç–∏—Ö). –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è (1_3/5), –æ—Å–∫—ñ–ª—å–∫–∏ Word —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î _ —è–∫ –Ω–∏–∂–Ω—ñ–π —ñ–Ω–¥–µ–∫—Å
- –†–æ–∑–¥—ñ–ª—è–π—Ç–µ –æ–∫—Ä–µ–º—ñ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –≤–∏—Ä–∞–∑–∏ –ø—Ä–æ–±—ñ–ª–∞–º–∏ –¥–ª—è –∫—Ä–∞—â–æ—ó —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ: "(7/8) - (1/2)" –∑–∞–º—ñ—Å—Ç—å "(7/8)-(1/2)", "1 (1/3)" –∑–∞–º—ñ—Å—Ç—å "1(1/3)"

–ü—Ä–∏–∫–ª–∞–¥:
1 | –Ø–∫–∞ –º–æ–≤–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–µ–±-—Ä–æ–∑—Ä–æ–±–∫–∏? | –ê | 2 | JavaScript | Python | C++ | Java | –¢–û
1 | –©–æ —Ç–∞–∫–µ HTML? | –ë | 1 | –ú–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è | –ú–æ–≤–∞ —Ä–æ–∑–º—ñ—Ç–∫–∏ | –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö | –û–° | –¢–û
2 | –Ø–∫—ñ –º–æ–≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –≤–µ–±-—Ä–æ–∑—Ä–æ–±–∫–∏? | –ê–í | 2 | JavaScript | Python | C++ | Java | –¢–ö
3 | –Ø–∫–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ —á–∏—Å–ª–æ –≤ –¥–≤—ñ–π–∫–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ –∑ 2 —Ä–æ–∑—Ä—è–¥—ñ–≤ | 3 | 3 | | | | | –í–ü
4 | –°–∫—ñ–ª—å–∫–∏ –±—É–¥–µ 2+2? | –ì | 1 | 3 | 5 | 4 | 6 | –¢–û
5 | –°–ø—Ä–æ—Å—Ç—ñ—Ç—å –≤–∏—Ä–∞–∑ (x^2 - 1)/(x - 1) | x + 1 | 2 | | | | | –í–ü
6 | –û–±—á–∏—Å–ª—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏—Ä–∞–∑—É 2^3 + sqrt(16) | 12 | 3 | | | | | –í–ü

–ó–∞–º—ñ–Ω—ñ—Ç—å [–ö–Ü–õ–¨–ö–Ü–°–¢–¨], [–°–ö–õ–ê–î–ù–Ü–°–¢–¨] —Ç–∞ [–¢–ï–ú–ê] –Ω–∞ –≤–∞—à—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.
"""
        
        # –î–æ–¥–∞—î–º–æ –∑–∞–ø–∏—Ç –≤ –¥–æ–∫—É–º–µ–Ω—Ç
        query_paragraph = doc.add_paragraph(query_text)
        query_paragraph.style = 'Normal'
        
        # –†–æ–∑–¥—ñ–ª –∑ –ø—Ä–∏–º—ñ—Ç–∫–∞–º–∏
        doc.add_heading('–í–∞–∂–ª–∏–≤—ñ –ø—Ä–∏–º—ñ—Ç–∫–∏:', level=1)
        
        notes = [
            "–ó–∞–º—ñ–Ω—ñ—Ç—å [–¢–ï–ú–ê] –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É —Ç–µ–º—É –≤–∞—à–æ–≥–æ —Ç–µ—Å—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: '–û—Å–Ω–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è', '–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏', '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ 8 –∫–ª–∞—Å')",
            "–ó–∞–º—ñ–Ω—ñ—Ç—å [–°–ö–õ–ê–î–ù–Ü–°–¢–¨] –Ω–∞ –±–∞–∂–∞–Ω–∏–π —Ä—ñ–≤–µ–Ω—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: '–ø–æ—á–∞—Ç–∫–æ–≤–∏–π', '—Å–µ—Ä–µ–¥–Ω—ñ–π', '–ø—Ä–æ—Å—É–Ω—É—Ç–∏–π', '–¥–ª—è 8 –∫–ª–∞—Å—É')",
            "–ó–∞–º—ñ–Ω—ñ—Ç—å [–ö–Ü–õ–¨–ö–Ü–°–¢–¨] –Ω–∞ –ø–æ—Ç—Ä—ñ–±–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: '10', '15', '20')",
            "–ù–µ–π—Ä–æ–º–µ—Ä–µ–∂–∞ —Å—Ç–≤–æ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—é –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ - —Å–∫–æ–ø—ñ—é–π—Ç–µ —ó—ó –≤ Excel",
            "–í–ê–ñ–õ–ò–í–û: –í–∏–¥–∞–ª—ñ—Ç—å —Ä—è–¥–æ–∫ –∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ –≤ —à–∞–±–ª–æ–Ω—ñ –ø–µ—Ä–µ–¥ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è–º - –¥–∞–Ω—ñ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ—á–∏–Ω–∞—Ç–∏—Å—è –∑ –¥—Ä—É–≥–æ–≥–æ —Ä—è–¥–∫–∞",
            "–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –¥–∞–Ω—ñ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –¥—Ä—É–≥–æ–≥–æ —Ä—è–¥–∫–∞",
            "–î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏—Ö –ø–∏—Ç–∞–Ω—å –ø–æ–ø—Ä–æ—Å—ñ—Ç—å –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂—É —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏"
        ]
        
        for note in notes:
            p = doc.add_paragraph()
            p.add_run('‚Ä¢ ').bold = True
            p.add_run(note)
        
        # –†–æ–∑–¥—ñ–ª –∑ –ø—Ä–∏–∫–ª–∞–¥–æ–º –≥–æ—Ç–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É
        doc.add_heading('–ü—Ä–∏–∫–ª–∞–¥ –≥–æ—Ç–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É:', level=1)
        
        example_query = """
–°—Ç–≤–æ—Ä–∏ —Ç–µ—Å—Ç –Ω–∞ —Ç–µ–º—É "–û—Å–Ω–æ–≤–∏ –≤–µ–±-—Ä–æ–∑—Ä–æ–±–∫–∏" —Ä—ñ–≤–Ω—è —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ "—Å–µ—Ä–µ–¥–Ω—ñ–π" —É —Ñ–æ—Ä–º–∞—Ç—ñ Excel —Ç–∞–±–ª–∏—Ü—ñ.

[... –≤–µ—Å—å —Ç–µ–∫—Å—Ç –∑–∞–ø–∏—Ç—É –≤–∏—â–µ ...]

–°—Ç–≤–æ—Ä–∏ 15 –ø–∏—Ç–∞–Ω—å –Ω–∞ —Ç–µ–º—É "–û—Å–Ω–æ–≤–∏ –≤–µ–±-—Ä–æ–∑—Ä–æ–±–∫–∏" –∑ —Ä—ñ–≤–Ω–µ–º —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ "—Å–µ—Ä–µ–¥–Ω—ñ–π".
–í–∫–ª—é—á–∏ —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –ø–∏—Ç–∞–Ω—å: –∑ –≤–∏–±–æ—Ä–æ–º –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Ç–∞ –≤—ñ–¥–∫—Ä–∏—Ç—ñ.
–†–æ–∑–ø–æ–¥—ñ–ª–∏ –≤–∞–≥–∏ –≤—ñ–¥ 1 –¥–æ 5 –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –∫–æ–∂–Ω–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–Ω—è.
"""
        
        example_paragraph = doc.add_paragraph(example_query)
        example_paragraph.style = 'Normal'
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –ø–∏—Ç–∞–Ω—å –∑ –≤—ñ–¥–∫—Ä–∏—Ç–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é
        doc.add_heading('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –ø–∏—Ç–∞–Ω—å –∑ –≤—ñ–¥–∫—Ä–∏—Ç–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é:', level=1)
        
        open_ended_recommendations = [
            "–í—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∏–º–∏ —Ç–∞ –Ω–µ –¥–æ–ø—É—Å–∫–∞—Ç–∏ –≤–∞—Ä—ñ–∞—Ü—ñ–π",
            "–£–Ω–∏–∫–∞–π—Ç–µ —ñ–Ω–¥–µ–∫—Å—ñ–≤, –Ω–æ–º–µ—Ä—ñ–≤ –∞–±–æ –ø–æ–∑–Ω–∞—á–µ–Ω—å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: '–ø–µ—Ä—à–∏–π', '–¥—Ä—É–≥–∏–π', '–∞)', '–±)')",
            "–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–¥–Ω—ñ –π —Ç—ñ –∂ –æ–¥–∏–Ω–∏—Ü—ñ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è –≤ –ø–∏—Ç–∞–Ω–Ω—ñ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ",
            "–í—ñ–¥–¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥—É –≤—ñ–¥–ø–æ–≤—ñ–¥—è–º –∑ –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∞–±–æ —á–∏—Å–ª–∞",
            "–î–ª—è —á–∏—Å–ª–æ–≤–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –≤–∫–∞–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è"
        ]
        
        for rec in open_ended_recommendations:
            p = doc.add_paragraph()
            p.add_run('‚ö†Ô∏è ').bold = True
            p.add_run(rec)
        
        # –ü—Ä–∏–∫–ª–∞–¥–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö —Ç–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –ø–∏—Ç–∞–Ω—å
        doc.add_heading('–ü—Ä–∏–∫–ª–∞–¥–∏ –ø–∏—Ç–∞–Ω—å –∑ –≤—ñ–¥–∫—Ä–∏—Ç–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é:', level=2)
        
        doc.add_paragraph().add_run('‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏:').bold = True
        correct_examples = [
            "–°–∫—ñ–ª—å–∫–∏ –¥–Ω—ñ–≤ —É –ª—é—Ç–æ–º—É –≤–∏—Å–æ–∫–æ—Å–Ω–æ–≥–æ —Ä–æ–∫—É? –í—ñ–¥–ø–æ–≤—ñ–¥—å: 29",
            "–Ø–∫–∞ —Å—Ç–æ–ª–∏—Ü—è –§—Ä–∞–Ω—Ü—ñ—ó? –í—ñ–¥–ø–æ–≤—ñ–¥—å: –ü–∞—Ä–∏–∂",
            "–°–∫—ñ–ª—å–∫–∏ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä—ñ–≤ —É –æ–¥–Ω–æ–º—É –º–µ—Ç—Ä—ñ? –í—ñ–¥–ø–æ–≤—ñ–¥—å: 100",
            "–Ø–∫–∞ —Ö—ñ–º—ñ—á–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞ –≤–æ–¥–∏? –í—ñ–¥–ø–æ–≤—ñ–¥—å: H2O"
        ]
        
        for example in correct_examples:
            p = doc.add_paragraph()
            p.add_run('‚Ä¢ ').bold = True
            p.add_run(example)
        
        doc.add_paragraph().add_run('‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏:').bold = True
        incorrect_examples = [
            "–Ø–∫–∏–π –ø–µ—Ä—à–∏–π –µ–ª–µ–º–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ñ –ú–µ–Ω–¥–µ–ª—î—î–≤–∞? (—É–Ω–∏–∫–∞–π—Ç–µ '–ø–µ—Ä—à–∏–π')",
            "–°–∫—ñ–ª—å–∫–∏ –º–µ—Ç—Ä—ñ–≤ —É –∫—ñ–ª–æ–º–µ—Ç—Ä—ñ, –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö? (—Ä—ñ–∑–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ)",
            "–ù–∞–∑–≤—ñ—Ç—å –Ω–∞–π–±—ñ–ª—å—à—É –ø–ª–∞–Ω–µ—Ç—É? (–º–æ–∂–µ –±—É—Ç–∏ '–Ω–∞–π–±—ñ–ª—å—à–∞' –∞–±–æ '–Æ–ø—ñ—Ç–µ—Ä')",
            "–°–∫—ñ–ª—å–∫–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ –≤–∞–∂–∏—Ç—å —Å–ª–æ–Ω? (–±–µ–∑ —Ç–æ—á–Ω–æ–≥–æ –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—è)"
        ]
        
        for example in incorrect_examples:
            p = doc.add_paragraph()
            p.add_run('‚Ä¢ ').bold = True
            p.add_run(example)
        
        # –§—ñ–Ω–∞–ª—å–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
        doc.add_heading('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –ø–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é:', level=1)
        
        recommendations = [
            "–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü–µ–π –∑–∞–ø–∏—Ç –∑ ChatGPT, Claude, Gemini –∞–±–æ —ñ–Ω—à–∏–º–∏ –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂–∞–º–∏",
            "–ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–∫–æ–ø—ñ—é–π—Ç–µ —Ç–∞–±–ª–∏—Ü—é –≤ Excel —Ç–∞ –∑–±–µ—Ä–µ–∂—ñ—Ç—å —Ñ–∞–π–ª",
            "–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Ñ–∞–π–ª –≤ —Å–∏—Å—Ç–µ–º—É TeacherTest –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤",
            "–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º",
            "–ó–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—Ä—É—á–Ω—É"
        ]
        
        for rec in recommendations:
            p = doc.add_paragraph()
            p.add_run('‚úì ').bold = True
            p.add_run(rec)
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        os.makedirs(os.path.dirname(output_path), exist_ok=True)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
        doc.save(output_path)
        log.info(f"–î–æ–∫—É–º–µ–Ω—Ç –∑ –∑–∞–ø–∏—Ç–æ–º –¥–ª—è –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂—ñ —Å—Ç–≤–æ—Ä–µ–Ω–æ: {output_path}")
        
    except Exception as e:
        log.error(f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∑ –∑–∞–ø–∏—Ç–æ–º: {e}")
        raise